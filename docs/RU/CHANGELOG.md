# История изменений ControlBot

Все значимые изменения в проекте ControlBot будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект следует [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [3.1.0] - 2025-11-09

### Добавлено
- **Система inline-меню** - интерактивная навигация по командам бота через inline-кнопки
- **Многостраничное меню** - разделение команд на 3 страницы для удобной навигации
- **Категории команд** - группировка команд по функциональным категориям (Процессы, Пути, Файлы, Мониторинг, Командная строка, Удаленное управление, Мышь, Клавиатура, Экран, Прочее)
- **Справка по категориям** - полная справка по всем командам категории одним нажатием
- **app/handlers/menu.py** - новый модуль для управления inline-меню
- **Скрипты автоматической установки** - упрощенное развертывание на Windows
  - **setup.bat** - автоматическая настройка окружения (создание venv, установка зависимостей)
  - **start.bat** - запуск бота через виртуальное окружение
  - **install_autostart.bat** - добавление бота в автозагрузку Windows
  - **uninstall_autostart.bat** - удаление бота из автозагрузки

### Изменено
- **Команда /start** - теперь отображает inline-меню с кнопками категорий
- **app/handlers/help.py** - добавлена интеграция с системой inline-меню
- **app/handlers/registration.py** - добавлен импорт модуля menu
- **Система навигации** - улучшен пользовательский опыт с визуальными кнопками

### Особенности
- **Обратная совместимость** - все команды продолжают работать через прямой ввод
- **Удобство использования** - команды отображаются в `<code>` тегах для быстрого копирования
- **Интуитивная навигация** - переключение между страницами меню с индикаторами (1/3, 2/3, 3/3)
- **Подробная справка** - возможность получить полную справку по всем командам категории

### Ограничения
- **Кнопки выполнения команд** - inline-кнопки для прямого выполнения команд (callback_data: `exec:/команда`) являются заглушками для будущей реализации. Текущий механизм через `feed_update()` может работать некорректно. Для выполнения команд используйте прямой ввод команд или копирование из `<code>` тегов

## [3.0.0] - 2025-11-06

### Удалено
- **Headless-режим для GitHub Actions** - полностью удален функционал headless-режима
- **app/gui_utils.py** - файл с утилитами для headless-режима
- **docs/RU/HEADLESS.md** - документация по headless-режиму
- **GUI_ENABLED** - переменная окружения и настройка в конфигурации
- **Ленивые импорты GUI модулей** - `lazy_import_cv2()`, `lazy_import_pyautogui()`, `lazy_import_pil()`

### Изменено
- **Обработчики команд** - заменены ленивые импорты на прямые импорты GUI модулей
- **app/handlers/attachments.py** - упрощена обработка ошибок, удалена специальная логика для headless
- **app/handlers/mouse_keyboard.py** - прямые импорты cv2 и pyautogui
- **app/handlers/screen.py** - прямые импорты pyautogui и PIL.ImageGrab
- **app/handlers/remote_desktop.py** - прямой импорт pyautogui
- **app/config/__init__.py** - удалено поле `gui_enabled` из класса Settings
- **Документация** - удалены все упоминания headless-режима из README.md и CONFIG.md
- **README.md** - обновлена версия до v3.0.0 с описанием изменений
- **Централизованная система логирования** - улучшена асинхронность операций экспорта с использованием `asyncio.to_thread()`

### Примечание
Это мажорное обновление с несовместимыми изменениями. Headless-режим больше не поддерживается. Для работы бота теперь всегда требуется GUI-окружение с доступным дисплеем.


---

## Типы изменений

- **Добавлено** - для новых функций
- **Изменено** - для изменений в существующей функциональности
- **Устарело** - для функций, которые будут удалены в будущих версиях
- **Удалено** - для удаленных функций
- **Исправлено** - для исправления багов
- **Безопасность** - для исправлений уязвимостей

## Формат версий

Проект использует [Semantic Versioning](https://semver.org/):
- **MAJOR** - несовместимые изменения API
- **MINOR** - новая функциональность с обратной совместимостью
- **PATCH** - исправления багов с обратной совместимостью

## Планы на будущее

См. [FUTURE.md](FUTURE.md) для информации о планируемых функциях и улучшениях.
